<!---TODO: Zach --->
<!---TODO: Sid --->
<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="LISTINGS.css">
	<link rel="stylesheet" type="text/css" href="userPage.css">

    <title>FarmerLink</title>
</head>

<body>
    <header class="p-3 bg-dark text-black" id="main-header">
        <div class="container">
            <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
                <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
              <h3 id="main-heading">FarmerLink</h1>
              <li><a href="index.html" class="nav-link px-2 text-white">Home</a></li>
              <li><a href="crops.html" class="nav-link px-2 text-white">Crops</a></li>
              <li><a href="listings.html" class="nav-link px-2 text-white">Listings</a></li>
              <li><a href="forum.html" class="nav-link px-2 text-white">Forum</a></li>
                </ul>

                <div class="text-end">
                 <a href="userPage.html" button type="button" class="btn btn-light" id = "profile-button">My Profile</a>
				 <a href="search.html" button type="button" class="btn btn-light" id = "profile-button">Search Profiles</a>

                </div>
            </div>
        </div>
    </header>


    <div class="container-fluid" id="main-page-name">
        <h2 id="main-page-heading">Listings</h1>
    </div>

    <!-- Add your html inside here -->
    <div class="container-fluid" >
        <h2 id="sub-page-heading">Check out local listings in your area!</h1>
    </div>
    
    
    <div class="row container-fluid">
        <div class="col-4 themed-grid-col"><strong>Name</strong></div>
        <div class="col-4-long themed-grid-col"><strong>Location</strong></div>
        <div class="col-4-long themed-grid-col"><strong>Details</strong></div>
        <div class="col-4-long themed-grid-col"><strong>Contact</strong></div>
    </div>
    <div id="listings">
        <div class="row container-fluid">
            <div class="col-4 themed-grid-col">Sample name 1</div>
            <div class="col-4-long themed-grid-col">Sample location 1</div>
            <div class="col-4-long themed-grid-col">Sample details1</div>
            <div class="col-4-long themed-grid-col">Sample contact 1</div>
        </div>
        <div class="row container-fluid">
            <div class="col-4 themed-grid-col">Sample name 2</div>
            <div class="col-4-long themed-grid-col">Sample location 2</div>
            <div class="col-4-long themed-grid-col">Sample details 2</div>
            <div class="col-4-long themed-grid-col">Sample contact 2</div>
        </div>
        <div class="row container-fluid">
            <div class="col-4 themed-grid-col">Sample name 3</div>
            <div class="col-4-long themed-grid-col">Sample location 3</div>
            <div class="col-4-long themed-grid-col">Sample details 3</div>
            <div class="col-4-long themed-grid-col">Sample contact 3</div>
        </div>
    </div>
    

    <div class="container-fluid centered" id="submit-button-div">
        <button type="button" class="btn btn-success" id="refreshBtn">Refresh</button>
    </div>

    <footer class="footer mt-auto py-3 bg-dark" id="main-footer">
        <div class="text-center p-3" id="about-footer">
            <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
                <li><a href="#" class="nav-link px-2 text-white" id="footer-text">About</a></li>
            </ul>
        </div>
    </footer>
    <script type = "text/javascript">
        let refreshButtonObj = document.getElementById("refreshBtn");
        async function refreshButton() {
            
            
            let n = 3;
            let res = await fetch("http://localhost:3000/listings/getListings", {
                method: 'GET',
                mode: 'cors',
                headers: {
                    'Content-Type': 'application/json'
                }});
            
            let data = await res.json();
            console.log(data);
            let outerDiv = document.getElementById('listings');
            outerDiv.innerHTML = '';

            for(let i = 0; i < n; i++) {
                let rowDiv = document.createElement("div");
                rowDiv.classList.add('row');
                rowDiv.classList.add('container-fluid');

                let currRow = data[i];
                console.log(currRow);
                let nameDiv = document.createElement("div");
                let locationDiv = document.createElement("div");
                let detailsDiv = document.createElement("div");
                let contactDiv = document.createElement("div");

                nameDiv.classList.add("col-4");
                nameDiv.classList.add("themed-grid-col");
                locationDiv.classList.add("col-4-long");
                locationDiv.classList.add("themed-grid-col");

                detailsDiv.classList.add("col-4-long");
                detailsDiv.classList.add("themed-grid-col");

                contactDiv.classList.add("col-4-long");
                contactDiv.classList.add("themed-grid-col");

                nameDiv.innerHTML = currRow.name;
                locationDiv.innerHTML = currRow.location;
                detailsDiv.innerHTML = currRow.details;
                contactDiv.innerHTML = currRow.contact;

                rowDiv.appendChild(nameDiv);
                rowDiv.appendChild(locationDiv);
                rowDiv.appendChild(detailsDiv);
                rowDiv.appendChild(contactDiv);

                outerDiv.appendChild(rowDiv);
            }

        }
        refreshButtonObj.onclick = () => {refreshButton();};
    </script>
</body>

</html>

